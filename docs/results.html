<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Results | YOUR TITLE HERE</title>
  <meta name="description" content="Chapter 5 Results | YOUR TITLE HERE" />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Results | YOUR TITLE HERE" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Results | YOUR TITLE HERE" />
  
  
  

<meta name="author" content="Yichi Zhang, Zelin Li, Huayun Xu, Mingfang Chang" />


<meta name="date" content="2019-12-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="missing-values.html"/>
<link rel="next" href="interactive-component.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.css" rel="stylesheet" />
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.Default.css" rel="stylesheet" />
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.freezable.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.layersupport.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">SHORT TITLE HERE</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="data-sources.html"><a href="data-sources.html"><i class="fa fa-check"></i><b>2</b> Data sources</a></li>
<li class="chapter" data-level="3" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>3</b> Data transformation</a></li>
<li class="chapter" data-level="4" data-path="missing-values.html"><a href="missing-values.html"><i class="fa fa-check"></i><b>4</b> Missing values</a></li>
<li class="chapter" data-level="5" data-path="results.html"><a href="results.html"><i class="fa fa-check"></i><b>5</b> Results</a></li>
<li class="chapter" data-level="6" data-path="interactive-component.html"><a href="interactive-component.html"><i class="fa fa-check"></i><b>6</b> Interactive component</a></li>
<li class="chapter" data-level="7" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>7</b> Conclusion</a></li>
<li class="chapter" data-level="8" data-path="leaflet.html"><a href="leaflet.html"><i class="fa fa-check"></i><b>8</b> Interactive Geographic Data</a><ul>
<li class="chapter" data-level="8.1" data-path="leaflet.html"><a href="leaflet.html#overview"><i class="fa fa-check"></i><b>8.1</b> Overview</a></li>
<li class="chapter" data-level="8.2" data-path="leaflet.html"><a href="leaflet.html#brief-description-about-dataset"><i class="fa fa-check"></i><b>8.2</b> Brief Description about Dataset</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">YOUR TITLE HERE</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="results" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Results</h1>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="kw">library</span>(choroplethrMaps)</a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="kw">library</span>(choroplethr)</a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="kw">library</span>(viridis)</a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="kw">library</span>(chron)</a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="kw">library</span>(tidyverse)</a></code></pre></div>
<p>In chapter 3, we have dropped some trivial crime types like “CRIMINAL MISCHIEF” and now we only pay attention to the common crime types of events happened in NYC. There are 11 crime types in total and we can see the frequency rank of them in the following graph.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">df1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(df_select[,<span class="dv">4</span>])</a>
<a class="sourceLine" id="cb17-2" data-line-number="2">df1[<span class="st">&#39;count&#39;</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb17-3" data-line-number="3">df1&lt;-<span class="st"> </span>df1 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="st">  </span><span class="kw">group_by</span>(df_select...<span class="fl">4.</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">Freq =</span> <span class="kw">sum</span>(count))</a>
<a class="sourceLine" id="cb17-6" data-line-number="6"></a>
<a class="sourceLine" id="cb17-7" data-line-number="7"><span class="kw">ggplot</span>(df1, <span class="kw">aes</span>(<span class="kw">reorder</span>(df_select...<span class="fl">4.</span>,df1<span class="op">$</span>Freq), <span class="dt">y =</span> df1<span class="op">$</span>Freq)) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>,<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>,<span class="dt">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb17-9" data-line-number="9"><span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb17-10" data-line-number="10"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Crime Types&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Total amount&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Major Crimes in NYC&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
<p>As we can see, THIEF is the most common crime in NYC and we deduce that this phenomenon may result from the low cost of theft. Offence also appears very common, because there are many different types of crime could be classified as OFFENCE. ARSON, MURDER and KIDNAPPING are the least common crime types in the dataset.</p>
<p>For the convenience of the later researches, we drop 5 types of crime from our dataset: ARSON, MURDER, KIDNAPPING, DRUG and FRAUD.</p>
<p>MURDER related data has great amount of missing data for latitude and longitude, also ARSON, MURDER and KIDNAPPING contain very few useful pieces of data, which is difficult to conduct instructive analysis. We drop FRAUD because this could be avoided effectively. For DRUG, although it is very common, usually it is the indirect reason for other crimes like offence or murder, the crime DRUG itself usually doesn’t cause great harm to the society.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">dangerous &lt;-<span class="kw">c</span>(<span class="st">&#39;BURGLARY&#39;</span>,<span class="st">&#39;OFFENSE&#39;</span>,<span class="st">&#39;RAPE&#39;</span>,<span class="st">&#39;ROBBERY&#39;</span>,<span class="st">&#39;THIEF&#39;</span>,<span class="st">&#39;WEAPON&#39;</span>)</a>
<a class="sourceLine" id="cb18-2" data-line-number="2">df_select &lt;-<span class="st"> </span>df_select <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">OFNS_DESC =</span> <span class="kw">ifelse</span>(OFNS_DESC <span class="op">%in%</span><span class="st"> </span>dangerous, OFNS_DESC, <span class="ot">NA</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">drop_na</span>(OFNS_DESC)</a>
<a class="sourceLine" id="cb18-3" data-line-number="3">df_select &lt;-<span class="st"> </span><span class="kw">drop_na</span>(df_select, BORO_NM)</a></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">DATA2 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;QuickFacts.csv&quot;</span>)</a>
<a class="sourceLine" id="cb19-2" data-line-number="2"></a>
<a class="sourceLine" id="cb19-3" data-line-number="3">DATA2 &lt;-DATA2[, <span class="kw">colSums</span>(<span class="kw">is.na</span>(DATA2)) <span class="op">!=</span><span class="st"> </span><span class="kw">nrow</span>(DATA2)]</a>
<a class="sourceLine" id="cb19-4" data-line-number="4">DATA2 &lt;-DATA2[,<span class="op">-</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">8</span>)]</a>
<a class="sourceLine" id="cb19-5" data-line-number="5">DATA2 &lt;-<span class="kw">as.data.frame</span>(<span class="kw">t</span>(DATA2))</a>
<a class="sourceLine" id="cb19-6" data-line-number="6"><span class="kw">names</span>(DATA2) &lt;-<span class="st"> </span><span class="kw">as.character</span>(<span class="kw">unlist</span>(DATA2[<span class="dv">1</span>,]))</a>
<a class="sourceLine" id="cb19-7" data-line-number="7">DATA2 &lt;-<span class="st"> </span>DATA2[<span class="op">-</span><span class="dv">1</span>,]</a>
<a class="sourceLine" id="cb19-8" data-line-number="8"></a>
<a class="sourceLine" id="cb19-9" data-line-number="9">DATA2 &lt;-<span class="kw">as.data.frame</span>(DATA2[,<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb19-10" data-line-number="10"></a>
<a class="sourceLine" id="cb19-11" data-line-number="11"><span class="kw">names</span>(DATA2)&lt;-<span class="st">&#39;Population&#39;</span></a>
<a class="sourceLine" id="cb19-12" data-line-number="12"></a>
<a class="sourceLine" id="cb19-13" data-line-number="13"><span class="kw">row.names</span>(DATA2) &lt;-<span class="kw">c</span>(<span class="st">&#39;MANHATTAN&#39;</span>,<span class="st">&#39;BRONX&#39;</span>,<span class="st">&#39;QUEENS&#39;</span>,<span class="st">&#39;BROOKLYN&#39;</span>,<span class="st">&#39;STATEN ISLAND&#39;</span>)</a>
<a class="sourceLine" id="cb19-14" data-line-number="14"></a>
<a class="sourceLine" id="cb19-15" data-line-number="15"></a>
<a class="sourceLine" id="cb19-16" data-line-number="16">ChorDF &lt;-df_select<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-17" data-line-number="17"><span class="st">  </span><span class="kw">group_by</span>(df_select<span class="op">$</span>BORO_NM) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-18" data-line-number="18"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">count=</span><span class="kw">n</span>())<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-19" data-line-number="19"><span class="st">  </span><span class="kw">ungroup</span>()</a>
<a class="sourceLine" id="cb19-20" data-line-number="20"></a>
<a class="sourceLine" id="cb19-21" data-line-number="21">ChorDF &lt;-<span class="st"> </span><span class="kw">data.frame</span>(ChorDF[,<span class="op">-</span><span class="dv">1</span>], <span class="dt">row.names =</span> <span class="kw">unlist</span>(ChorDF[,<span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb19-22" data-line-number="22"></a>
<a class="sourceLine" id="cb19-23" data-line-number="23">ChorDF &lt;-<span class="st"> </span><span class="kw">merge</span>(ChorDF,DATA2,<span class="dt">by =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb19-24" data-line-number="24"></a>
<a class="sourceLine" id="cb19-25" data-line-number="25"></a>
<a class="sourceLine" id="cb19-26" data-line-number="26">ChorDF<span class="op">$</span>count &lt;-<span class="kw">as.numeric</span>(ChorDF<span class="op">$</span>count)</a>
<a class="sourceLine" id="cb19-27" data-line-number="27"></a>
<a class="sourceLine" id="cb19-28" data-line-number="28">ChorDF<span class="op">$</span>Population &lt;-<span class="kw">as.numeric</span>((<span class="kw">gsub</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">,&quot;</span>, <span class="st">&quot;&quot;</span>, ChorDF<span class="op">$</span>Population)))</a>
<a class="sourceLine" id="cb19-29" data-line-number="29"></a>
<a class="sourceLine" id="cb19-30" data-line-number="30">ChorDF &lt;-ChorDF <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-31" data-line-number="31"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">rate =</span> <span class="kw">as.double</span>(count<span class="op">/</span>Population)<span class="op">*</span><span class="dv">100000</span>)</a>
<a class="sourceLine" id="cb19-32" data-line-number="32"></a>
<a class="sourceLine" id="cb19-33" data-line-number="33">ChorDF[,<span class="st">&#39;region&#39;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb19-34" data-line-number="34"></a>
<a class="sourceLine" id="cb19-35" data-line-number="35"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(ChorDF)){</a>
<a class="sourceLine" id="cb19-36" data-line-number="36">  <span class="cf">if</span>(ChorDF[i,<span class="dv">1</span>] <span class="op">==</span><span class="st"> &#39;BRONX&#39;</span>){ChorDF[i,<span class="st">&#39;region&#39;</span>] &lt;-<span class="dv">36005</span>}</a>
<a class="sourceLine" id="cb19-37" data-line-number="37">  <span class="cf">if</span>(ChorDF[i,<span class="dv">1</span>] <span class="op">==</span><span class="st"> &#39;BROOKLYN&#39;</span>){ChorDF[i,<span class="st">&#39;region&#39;</span>] &lt;-<span class="dv">36047</span>}</a>
<a class="sourceLine" id="cb19-38" data-line-number="38">  <span class="cf">if</span>(ChorDF[i,<span class="dv">1</span>] <span class="op">==</span><span class="st"> &#39;MANHATTAN&#39;</span>){ChorDF[i,<span class="st">&#39;region&#39;</span>] &lt;-<span class="dv">36061</span>}</a>
<a class="sourceLine" id="cb19-39" data-line-number="39">  <span class="cf">if</span>(ChorDF[i,<span class="dv">1</span>] <span class="op">==</span><span class="st"> &#39;QUEENS&#39;</span>){ChorDF[i,<span class="st">&#39;region&#39;</span>] &lt;-<span class="st"> </span><span class="dv">36081</span>}</a>
<a class="sourceLine" id="cb19-40" data-line-number="40">  <span class="cf">if</span>(ChorDF[i,<span class="dv">1</span>] <span class="op">==</span><span class="st"> &#39;STATEN ISLAND&#39;</span>){ChorDF[i,<span class="st">&#39;region&#39;</span>] &lt;-<span class="dv">36085</span>}</a>
<a class="sourceLine" id="cb19-41" data-line-number="41">}</a>
<a class="sourceLine" id="cb19-42" data-line-number="42"></a>
<a class="sourceLine" id="cb19-43" data-line-number="43"><span class="kw">colnames</span>(ChorDF)[<span class="dv">4</span>] &lt;-<span class="st">&#39;value&#39;</span></a>
<a class="sourceLine" id="cb19-44" data-line-number="44"></a>
<a class="sourceLine" id="cb19-45" data-line-number="45"></a>
<a class="sourceLine" id="cb19-46" data-line-number="46"><span class="kw">data</span>(county.regions)</a>
<a class="sourceLine" id="cb19-47" data-line-number="47">nyc_county_names =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;kings&quot;</span>, <span class="st">&quot;bronx&quot;</span>, <span class="st">&quot;new york&quot;</span>, <span class="st">&quot;queens&quot;</span>, <span class="st">&quot;richmond&quot;</span>)</a>
<a class="sourceLine" id="cb19-48" data-line-number="48">nyc_county_fips =<span class="st"> </span>county.regions <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-49" data-line-number="49"><span class="st">  </span><span class="kw">filter</span>(state.name <span class="op">==</span><span class="st"> &quot;new york&quot;</span> <span class="op">&amp;</span><span class="st"> </span>county.name <span class="op">%in%</span><span class="st"> </span>nyc_county_names) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-50" data-line-number="50"><span class="st">  </span><span class="kw">select</span>(region)</a>
<a class="sourceLine" id="cb19-51" data-line-number="51"><span class="kw">county_choropleth</span>(ChorDF,</a>
<a class="sourceLine" id="cb19-52" data-line-number="52">                  <span class="dt">title =</span> <span class="st">&quot;Number of Selected Crime per 100000 Population for Five Borough&quot;</span>,</a>
<a class="sourceLine" id="cb19-53" data-line-number="53">                  <span class="dt">legend =</span> <span class="st">&quot;Crime Rate&quot;</span>,</a>
<a class="sourceLine" id="cb19-54" data-line-number="54">                  <span class="dt">county_zoom =</span> nyc_county_fips<span class="op">$</span>region)</a></code></pre></div>
<pre><code>## Warning in min(xx[xx &gt; upper]): no non-missing arguments to min; returning
## Inf</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
<p>After we selected the six most related crime to us, we take the population of each county into account and calculate the the crime rate of selected crime in five counties. The higher crime rate start from brooklyn along mahanttan to bronx whereas queens and staten island have lower crime rate. The suprsing thing is that, in our mind, brooklyn is always considered as a more dangerous county than mahanttan.</p>
<p>However,we cannot judge which county is more dangerous for us and which county is more safe from this graph. Since different person may have different rank for the dangerousness of the crime types.</p>
<p>As full-time students, we go out more frequently from Monday to Friday rather than weekends. Therefore we want to know the days with the most and least frequent number of crime events for each borough, and the plot is as following:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw">library</span>(chron)</a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="kw">ggplot</span>(df_select, <span class="kw">aes</span>(<span class="kw">factor</span>(<span class="kw">weekdays</span>(CMPLNT_FR_DT,<span class="dt">abbreviate =</span><span class="ot">TRUE</span>), <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;Mon&quot;</span>, <span class="st">&quot;Tue&quot;</span>, <span class="st">&quot;Wed&quot;</span>, <span class="st">&quot;Thu&quot;</span>, <span class="st">&quot;Fri&quot;</span>, <span class="st">&quot;Sat&quot;</span>, <span class="st">&quot;Sun&quot;</span>))))<span class="op">+</span></a>
<a class="sourceLine" id="cb21-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">fill=</span><span class="st">&quot;lightblue&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb21-5" data-line-number="5"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Weekdays&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb21-6" data-line-number="6"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;The Number of Crime Events in Weekdays by Borough in New York City&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb21-7" data-line-number="7"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="st">&quot;BORO_NM&quot;</span>, <span class="dt">scale=</span><span class="st">&quot;free&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
<p>Based on the above plot, the weekdays pattern is similar for each borough, where in the weekends the occurance of crime events is relatively infrequently compare to weekdays. Moreover, it seems that Staten Island is the best place to live if only safety is considered.</p>
<p>We want to figure out if there are special time of the year where more crimes happen. So we build the following graph for recognizing time series patterns.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">df2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(df_select[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>])</a>
<a class="sourceLine" id="cb22-2" data-line-number="2">df2[<span class="st">&#39;count&#39;</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb22-3" data-line-number="3">df2&lt;-<span class="st"> </span>df2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4"><span class="st">  </span><span class="kw">group_by</span>(CMPLNT_FR_DT) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-5" data-line-number="5"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">Freq =</span> <span class="kw">sum</span>(count))</a>
<a class="sourceLine" id="cb22-6" data-line-number="6"></a>
<a class="sourceLine" id="cb22-7" data-line-number="7">df2 &lt;-<span class="st"> </span>df2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-8" data-line-number="8"><span class="st">  </span><span class="kw">filter</span>(CMPLNT_FR_DT <span class="op">&gt;=</span><span class="kw">as.Date</span>(<span class="st">&#39;2019-01-01&#39;</span>))</a>
<a class="sourceLine" id="cb22-9" data-line-number="9"></a>
<a class="sourceLine" id="cb22-10" data-line-number="10"><span class="kw">ggplot</span>(df2, <span class="kw">aes</span>(<span class="kw">as.Date</span>(CMPLNT_FR_DT), <span class="dt">y =</span> Freq)) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-11" data-line-number="11"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">color=</span><span class="st">&quot;orange&quot;</span>)<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb22-12" data-line-number="12"><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>, <span class="dv">900</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb22-13" data-line-number="13"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Time&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Total amount&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Time series pattern in 2019&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-53-1.png" width="672" />
As shown in the graph, more crimes happened in the early Janaury and summer. Early Jauaury, especially during the new year celebration time, since more people went out for celebration, the raise of crime amount is reasonable. Besides, summer time is another period for more crimes. It may due to the relation between temperature and people’s moods.</p>
<p>Since this research is aimed to find the suitable and safe region for university students to live, we want to see the time series pattern in each borough.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">df2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(df_select[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>])</a>
<a class="sourceLine" id="cb23-2" data-line-number="2">df2[<span class="st">&#39;count&#39;</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb23-3" data-line-number="3"></a>
<a class="sourceLine" id="cb23-4" data-line-number="4">df2 &lt;-df2[<span class="op">!</span><span class="kw">is.na</span>(df2<span class="op">$</span>BORO_NM), ]</a>
<a class="sourceLine" id="cb23-5" data-line-number="5">df2&lt;-<span class="st"> </span>df2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-6" data-line-number="6"><span class="st">  </span><span class="kw">group_by</span>(BORO_NM,CMPLNT_FR_DT) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-7" data-line-number="7"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">Freq =</span> <span class="kw">sum</span>(count))</a>
<a class="sourceLine" id="cb23-8" data-line-number="8"></a>
<a class="sourceLine" id="cb23-9" data-line-number="9"></a>
<a class="sourceLine" id="cb23-10" data-line-number="10">df2 &lt;-<span class="st"> </span>df2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-11" data-line-number="11"><span class="st">  </span><span class="kw">filter</span>(CMPLNT_FR_DT <span class="op">&gt;=</span><span class="kw">as.Date</span>(<span class="st">&#39;2019-01-01&#39;</span>))</a>
<a class="sourceLine" id="cb23-12" data-line-number="12"></a>
<a class="sourceLine" id="cb23-13" data-line-number="13">df2[<span class="st">&quot;adjusted&quot;</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb23-14" data-line-number="14">df3 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(df2)</a>
<a class="sourceLine" id="cb23-15" data-line-number="15">DA &lt;-<span class="st"> </span><span class="kw">data.frame</span>(DATA2)</a>
<a class="sourceLine" id="cb23-16" data-line-number="16">DA<span class="op">$</span>Population &lt;-<span class="kw">as.numeric</span>((<span class="kw">gsub</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">,&quot;</span>, <span class="st">&quot;&quot;</span>, DA<span class="op">$</span>Population)))</a>
<a class="sourceLine" id="cb23-17" data-line-number="17"></a>
<a class="sourceLine" id="cb23-18" data-line-number="18"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1365</span>){</a>
<a class="sourceLine" id="cb23-19" data-line-number="19">  states &lt;-<span class="st"> </span>df3[i,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb23-20" data-line-number="20">  df3[i,<span class="st">&#39;adjusted&#39;</span>]&lt;-<span class="dv">100000</span><span class="op">*</span>df3[i,<span class="dv">3</span>]<span class="op">/</span>DA[states,<span class="st">&quot;Population&quot;</span>]</a>
<a class="sourceLine" id="cb23-21" data-line-number="21">}</a>
<a class="sourceLine" id="cb23-22" data-line-number="22"></a>
<a class="sourceLine" id="cb23-23" data-line-number="23"><span class="kw">ggplot</span>(df3, <span class="kw">aes</span>(<span class="kw">as.Date</span>(CMPLNT_FR_DT), <span class="dt">y =</span> Freq)) <span class="op">+</span></a>
<a class="sourceLine" id="cb23-24" data-line-number="24"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">color=</span><span class="st">&quot;orange&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb23-25" data-line-number="25"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>BORO_NM, <span class="dt">scales=</span><span class="st">&quot;free_y&quot;</span>,<span class="dt">ncol =</span> <span class="dv">2</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb23-26" data-line-number="26"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Time&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Crime Rate&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Time series pattern in 2019 in different boroughs&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-54-1.png" width="480" />
Among 5 boroughs, only MANHATTAN doesn’t show a decline trend. For MANHATTAN, Other boroughs all show the decline trend after September.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="co">#Cleveland dot plot</span></a>
<a class="sourceLine" id="cb24-2" data-line-number="2"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb24-3" data-line-number="3">cleveland &lt;-df_select[,<span class="kw">c</span>(<span class="st">&#39;BORO_NM&#39;</span>,<span class="st">&#39;OFNS_DESC&#39;</span>)]</a>
<a class="sourceLine" id="cb24-4" data-line-number="4"></a>
<a class="sourceLine" id="cb24-5" data-line-number="5">cleveland[<span class="st">&#39;Freq&#39;</span>] =<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb24-6" data-line-number="6"></a>
<a class="sourceLine" id="cb24-7" data-line-number="7">cleveland &lt;-<span class="st"> </span>cleveland <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-8" data-line-number="8"><span class="st">  </span><span class="kw">group_by</span>(BORO_NM,OFNS_DESC) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-9" data-line-number="9"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">Freq =</span> <span class="kw">log</span>(<span class="kw">sum</span>(Freq),<span class="dv">2</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-10" data-line-number="10"><span class="st">  </span><span class="kw">ungroup</span>()</a>
<a class="sourceLine" id="cb24-11" data-line-number="11"></a>
<a class="sourceLine" id="cb24-12" data-line-number="12"></a>
<a class="sourceLine" id="cb24-13" data-line-number="13">theme_dotplot &lt;-<span class="st"> </span><span class="kw">theme_bw</span>(<span class="dv">14</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb24-14" data-line-number="14"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="kw">rel</span>(.<span class="dv">55</span>)),</a>
<a class="sourceLine" id="cb24-15" data-line-number="15">          <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="kw">rel</span>(.<span class="dv">70</span>)),</a>
<a class="sourceLine" id="cb24-16" data-line-number="16">        <span class="dt">axis.ticks.y =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb24-17" data-line-number="17">        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="kw">rel</span>(.<span class="dv">70</span>)),</a>
<a class="sourceLine" id="cb24-18" data-line-number="18">        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="kw">rel</span>(.<span class="dv">70</span>)),</a>
<a class="sourceLine" id="cb24-19" data-line-number="19">        <span class="dt">panel.grid.major.x =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb24-20" data-line-number="20">        <span class="dt">panel.grid.major.y =</span> <span class="kw">element_line</span>(<span class="dt">size =</span> <span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb24-21" data-line-number="21">        <span class="dt">panel.grid.minor.x =</span> <span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb24-22" data-line-number="22"></a>
<a class="sourceLine" id="cb24-23" data-line-number="23"><span class="kw">ggplot</span>(cleveland,<span class="kw">aes</span>(Freq,<span class="kw">fct_reorder2</span>(BORO_NM,</a>
<a class="sourceLine" id="cb24-24" data-line-number="24">   OFNS_DESC <span class="op">==</span><span class="st"> &#39;THIEF&#39;</span>,Freq, <span class="dt">.desc =</span> <span class="ot">FALSE</span>),<span class="dt">color =</span> OFNS_DESC))<span class="op">+</span></a>
<a class="sourceLine" id="cb24-25" data-line-number="25"><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb24-26" data-line-number="26"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&#39;Boroughs&#39;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb24-27" data-line-number="27"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&#39;Crime Rate&#39;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb24-28" data-line-number="28"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&#39;Crime rate for each type by Boroughs &#39;</span>,<span class="dt">color =</span> <span class="st">&quot;Crime Type&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb24-29" data-line-number="29"><span class="st">  </span>theme_dotplot</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-55-1.png" width="672" />
The above graph showing the exactly crime rate for each type in five counties. The most frequent crime are Offense and thief for all counties. As we discuss above, the cost of theft is the lowest and definiton of offense is broadly defined which shoube be the reason for high frequency of this two crime type.</p>
<p>Therefore, we focus on other four types. It is interesting that Brooklyn have highest crime rate for all four serious cirme types(Rape,Robbery,weapon,burglary) but the total crime rate for brooklyn actually lower than manhattan. It seem like that the crimes happened in brookyln are more likely to be some serious crimes.</p>
<p>The bronx have second highest total crime rate and also second highest rate for all serious crime types. Therefroe both bronx and brooklyn are not good choice for student like us to choose from the safty concern.</p>
<p>For the staten island, the frepuency of all crime types are signifnatly lower then thoes of other four counties. From the safety concern, staten island maybe a good choice for moving to. However, the final deicison should take the commute time into account.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">picked_time &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;07am - 11am&quot;</span>, <span class="st">&quot;15pm - 19pm&quot;</span>, <span class="st">&quot;19pm - 23pm&quot;</span>)</a>
<a class="sourceLine" id="cb25-2" data-line-number="2">crime_color &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;#7851a9&quot;</span>, <span class="st">&quot;#800020&quot;</span>, <span class="st">&quot;#ef5927&quot;</span>, <span class="st">&quot;#0079c1&quot;</span>, <span class="st">&quot;#dac751&quot;</span>, <span class="st">&quot;#133a30&quot;</span>)</a>
<a class="sourceLine" id="cb25-3" data-line-number="3"></a>
<a class="sourceLine" id="cb25-4" data-line-number="4">df_select &lt;-<span class="st"> </span>df_select <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">drop_na</span>(BORO_NM)</a>
<a class="sourceLine" id="cb25-5" data-line-number="5">df_select &lt;-<span class="st"> </span>df_select <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">timerange =</span> CMPLNT_FR_TM)</a>
<a class="sourceLine" id="cb25-6" data-line-number="6">df_select &lt;-<span class="st"> </span>df_select <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">timerange =</span> <span class="kw">ifelse</span>(CMPLNT_FR_TM <span class="op">&gt;=</span><span class="st"> </span><span class="kw">chron</span>(<span class="dt">times=</span><span class="st">&quot;07:00:00&quot;</span>) </a>
<a class="sourceLine" id="cb25-7" data-line-number="7">                                                <span class="op">&amp;</span><span class="st"> </span>CMPLNT_FR_TM <span class="op">&lt;=</span><span class="st"> </span><span class="kw">chron</span>(<span class="dt">times=</span><span class="st">&quot;11:00:00&quot;</span>),</a>
<a class="sourceLine" id="cb25-8" data-line-number="8">                                                <span class="st">&quot;07am - 11am&quot;</span>, timerange) )</a>
<a class="sourceLine" id="cb25-9" data-line-number="9">df_select &lt;-<span class="st"> </span>df_select <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">timerange =</span> <span class="kw">ifelse</span>(CMPLNT_FR_TM <span class="op">&gt;=</span><span class="st"> </span><span class="kw">chron</span>(<span class="dt">times=</span><span class="st">&quot;15:00:00&quot;</span>) </a>
<a class="sourceLine" id="cb25-10" data-line-number="10">                                                <span class="op">&amp;</span><span class="st"> </span>CMPLNT_FR_TM <span class="op">&lt;=</span><span class="st"> </span><span class="kw">chron</span>(<span class="dt">times=</span><span class="st">&quot;19:00:00&quot;</span>),</a>
<a class="sourceLine" id="cb25-11" data-line-number="11">                                                <span class="st">&quot;15pm - 19pm&quot;</span>, timerange) )</a>
<a class="sourceLine" id="cb25-12" data-line-number="12">df_select &lt;-<span class="st"> </span>df_select <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">timerange =</span> <span class="kw">ifelse</span>(CMPLNT_FR_TM <span class="op">&gt;=</span><span class="st"> </span><span class="kw">chron</span>(<span class="dt">times=</span><span class="st">&quot;19:00:00&quot;</span>) </a>
<a class="sourceLine" id="cb25-13" data-line-number="13">                                                <span class="op">&amp;</span><span class="st"> </span>CMPLNT_FR_TM <span class="op">&lt;=</span><span class="st"> </span><span class="kw">chron</span>(<span class="dt">times=</span><span class="st">&quot;23:00:00&quot;</span>),</a>
<a class="sourceLine" id="cb25-14" data-line-number="14">                                                <span class="st">&quot;19pm - 23pm&quot;</span>, timerange) )</a>
<a class="sourceLine" id="cb25-15" data-line-number="15"></a>
<a class="sourceLine" id="cb25-16" data-line-number="16">df_select &lt;-<span class="st"> </span>df_select <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">color =</span> timerange)</a>
<a class="sourceLine" id="cb25-17" data-line-number="17">df_select &lt;-<span class="st"> </span>df_select <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>( <span class="dt">color =</span> <span class="kw">ifelse</span>(timerange <span class="op">==</span><span class="st"> </span>picked_time[<span class="dv">1</span>], <span class="st">&quot;red&quot;</span>, color) )</a>
<a class="sourceLine" id="cb25-18" data-line-number="18">df_select &lt;-<span class="st"> </span>df_select <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>( <span class="dt">color =</span> <span class="kw">ifelse</span>(timerange <span class="op">==</span><span class="st"> </span>picked_time[<span class="dv">2</span>], <span class="st">&quot;green&quot;</span>, color) )</a>
<a class="sourceLine" id="cb25-19" data-line-number="19">df_select &lt;-<span class="st"> </span>df_select <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>( <span class="dt">color =</span> <span class="kw">ifelse</span>(timerange <span class="op">==</span><span class="st"> </span>picked_time[<span class="dv">3</span>], <span class="st">&quot;blue&quot;</span>, color) )</a>
<a class="sourceLine" id="cb25-20" data-line-number="20"></a>
<a class="sourceLine" id="cb25-21" data-line-number="21">df_select &lt;-<span class="st"> </span>df_select <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">crimecolor =</span> OFNS_DESC)</a>
<a class="sourceLine" id="cb25-22" data-line-number="22"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(dangerous)){</a>
<a class="sourceLine" id="cb25-23" data-line-number="23">  df_select &lt;-<span class="st"> </span>df_select <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>( <span class="dt">crimecolor =</span> <span class="kw">ifelse</span>(OFNS_DESC <span class="op">==</span><span class="st"> </span>dangerous[i], crime_color[i], crimecolor) )   </a>
<a class="sourceLine" id="cb25-24" data-line-number="24">}</a>
<a class="sourceLine" id="cb25-25" data-line-number="25"></a>
<a class="sourceLine" id="cb25-26" data-line-number="26">df_select &lt;-<span class="st"> </span>df_select <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">timerange =</span> <span class="kw">ifelse</span>(timerange <span class="op">%in%</span><span class="st"> </span>picked_time, timerange, <span class="ot">NA</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">drop_na</span>(timerange)</a></code></pre></div>
<p>As a student, we rent a place because we need to go to school or job. So it is very important to avoid the places that have a higher chance of crime when we are walking to school, or coming back to home. Therefore, we have broken down the the time that the crime happened into the ranges that we cared about the most. Which are the following:</p>
<ol style="list-style-type: decimal">
<li>7am - 11am (the time when we go to school or work)</li>
<li>15pm - 19pm (the time we go back to home )</li>
<li>19pm - 23pm (the time we go back to home when we have night class)</li>
</ol>
<p>So we have created an interactive spatial map so that the user could explore the area and avoid the location that are dangerous at those time period.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="kw">ggplot</span>(df_select, <span class="kw">aes</span>(<span class="dt">x=</span>OFNS_DESC, ..count.., <span class="dt">fill=</span>timerange)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position=</span><span class="st">&quot;dodge&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-3" data-line-number="3"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>BORO_NM, <span class="dt">ncol=</span><span class="dv">2</span>,<span class="dt">scales=</span><span class="st">&quot;free_x&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb26-4" data-line-number="4"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">trans=</span><span class="st">&#39;log2&#39;</span>) </a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-57-1.png" width="576" /></p>
<p>Because we are all in the age group 18-24, and we want to find how we are related to the victims of crime events, first we plot the distribution of 5 age groups from &lt;18 to 65+ in each borough, and the result is as following:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">df_age &lt;-<span class="st"> </span><span class="kw">subset</span>(df_select, <span class="kw">as.character</span>(VIC_AGE_GROUP) <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;&lt;18&quot;</span>, <span class="st">&quot;18-24&quot;</span>, <span class="st">&quot;25-44&quot;</span>, <span class="st">&quot;45-64&quot;</span>,<span class="st">&quot;65+&quot;</span>) )</a>
<a class="sourceLine" id="cb27-2" data-line-number="2"><span class="kw">ggplot</span>(df_age, <span class="kw">aes</span>(VIC_AGE_GROUP))<span class="op">+</span></a>
<a class="sourceLine" id="cb27-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">fill=</span><span class="st">&quot;lightblue&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb27-4" data-line-number="4"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Age Groups&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb27-5" data-line-number="5"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;The Distribution of Age Groups of Victims by Borough in New York City&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb27-6" data-line-number="6"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="st">&quot;BORO_NM&quot;</span>, <span class="dt">scale=</span><span class="st">&quot;free&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-58-1.png" width="672" /></p>
<p>According to the graphs, we found that for each borough, the pattern of victims age group is similar, where the 25-44 age group has the largest number of victims, and the 45-64 age group has the second largest number of victims. For this plot it seems that the 18-24 age group among different boroughs is not apparent, so we extract the 18-24 group of each borough and draw the following barplot:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1">df_age2&lt;-<span class="kw">subset</span>(df_age, <span class="kw">as.character</span>(VIC_AGE_GROUP)<span class="op">==</span><span class="st">&quot;18-24&quot;</span>)</a>
<a class="sourceLine" id="cb28-2" data-line-number="2"><span class="co">#df_age2 &lt;- df_age2$VIC_AGE_GROUP</span></a>
<a class="sourceLine" id="cb28-3" data-line-number="3">df_age2 &lt;-df_age2<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb28-4" data-line-number="4"><span class="st">  </span><span class="kw">group_by</span>(df_age2<span class="op">$</span>BORO_NM) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb28-5" data-line-number="5"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">count=</span><span class="kw">n</span>())<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb28-6" data-line-number="6"><span class="st">  </span><span class="kw">ungroup</span>()</a>
<a class="sourceLine" id="cb28-7" data-line-number="7"><span class="kw">names</span>(df_age2)[<span class="dv">1</span>] &lt;-<span class="st"> &quot;Borough&quot;</span></a>
<a class="sourceLine" id="cb28-8" data-line-number="8">df_age2<span class="op">$</span>count &lt;-<span class="st"> </span>df_age2<span class="op">$</span>count<span class="op">/</span>ChorDF<span class="op">$</span>Population<span class="op">*</span><span class="dv">100000</span></a>
<a class="sourceLine" id="cb28-9" data-line-number="9"><span class="kw">names</span>(df_age2)[<span class="dv">2</span>] &lt;-<span class="st"> &quot;Rate&quot;</span></a>
<a class="sourceLine" id="cb28-10" data-line-number="10"><span class="kw">ggplot</span>(df_age2, <span class="kw">aes</span>(<span class="dt">x=</span><span class="kw">reorder</span>(Borough, <span class="op">-</span>Rate), <span class="dt">y=</span>Rate))<span class="op">+</span></a>
<a class="sourceLine" id="cb28-11" data-line-number="11"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>,<span class="dt">fill=</span><span class="st">&quot;lightblue&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb28-12" data-line-number="12"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Boroughs&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb28-13" data-line-number="13"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;The Number of Victims per 100000 People in 18-24 Age Group by Borough in New York City&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
<p>For this plot, we convert the count of crime events to crime rate per 100000 people, and we can see clearly that Manhattan has the largest crime rate, while staten island has the smallest crime rate.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1">df_race &lt;-df_select[,<span class="kw">c</span>(<span class="st">&#39;OFNS_DESC&#39;</span>,<span class="st">&#39;VIC_RACE&#39;</span>)]</a>
<a class="sourceLine" id="cb29-2" data-line-number="2">df_race &lt;-<span class="st"> </span>df_race <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb29-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(VIC_RACE <span class="op">!=</span><span class="st"> &#39;UNKNOWN&#39;</span>)</a>
<a class="sourceLine" id="cb29-4" data-line-number="4"></a>
<a class="sourceLine" id="cb29-5" data-line-number="5">df_race[<span class="st">&#39;count&#39;</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb29-6" data-line-number="6"></a>
<a class="sourceLine" id="cb29-7" data-line-number="7">df_race&lt;-<span class="st"> </span>df_race <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb29-8" data-line-number="8"><span class="st">  </span><span class="kw">group_by</span>(VIC_RACE,OFNS_DESC) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb29-9" data-line-number="9"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">Freq =</span> <span class="kw">log</span>(<span class="kw">sum</span>(count)))</a>
<a class="sourceLine" id="cb29-10" data-line-number="10"></a>
<a class="sourceLine" id="cb29-11" data-line-number="11"></a>
<a class="sourceLine" id="cb29-12" data-line-number="12"><span class="kw">ggplot</span>(df_race, <span class="kw">aes</span>(<span class="dt">x =</span> OFNS_DESC, <span class="dt">y =</span> Freq))<span class="op">+</span></a>
<a class="sourceLine" id="cb29-13" data-line-number="13"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>,<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>,<span class="dt">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-14" data-line-number="14"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>VIC_RACE, <span class="dt">scales=</span><span class="st">&quot;free&quot;</span>, <span class="dt">nrow =</span> <span class="dv">3</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb29-15" data-line-number="15"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">6</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb29-16" data-line-number="16"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Crime Types&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;log(Total amount)&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Major Crimes faced by different races in NYC&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-60-1.png" width="672" /></p>
<p>Also for different races, people may face different crime rate among different borough. In order to help students with different origins to make the proper choices, we make the following graph.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">df_race &lt;-df_select[,<span class="kw">c</span>(<span class="st">&#39;BORO_NM&#39;</span>,<span class="st">&#39;VIC_RACE&#39;</span>)]</a>
<a class="sourceLine" id="cb30-2" data-line-number="2">df_race &lt;-<span class="st"> </span>df_race <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb30-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(VIC_RACE <span class="op">!=</span><span class="st"> &#39;UNKNOWN&#39;</span>)</a>
<a class="sourceLine" id="cb30-4" data-line-number="4"></a>
<a class="sourceLine" id="cb30-5" data-line-number="5">df_race[<span class="st">&#39;count&#39;</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb30-6" data-line-number="6"></a>
<a class="sourceLine" id="cb30-7" data-line-number="7">df_race&lt;-<span class="st"> </span>df_race <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb30-8" data-line-number="8"><span class="st">  </span><span class="kw">group_by</span>(VIC_RACE,BORO_NM) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb30-9" data-line-number="9"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">Freq =</span> <span class="kw">sum</span>(count))</a>
<a class="sourceLine" id="cb30-10" data-line-number="10"></a>
<a class="sourceLine" id="cb30-11" data-line-number="11">df_race[<span class="st">&#39;adjusted&#39;</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb30-12" data-line-number="12">df_race &lt;-<span class="st"> </span><span class="kw">data.frame</span>(df_race)</a>
<a class="sourceLine" id="cb30-13" data-line-number="13"></a>
<a class="sourceLine" id="cb30-14" data-line-number="14"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">30</span>){</a>
<a class="sourceLine" id="cb30-15" data-line-number="15">  state &lt;-<span class="st"> </span>df_race[i,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb30-16" data-line-number="16">  df_race[i,<span class="st">&#39;adjusted&#39;</span>]&lt;-<span class="dv">100000</span><span class="op">*</span>df3[i,<span class="dv">3</span>]<span class="op">/</span>DA[state,<span class="st">&quot;Population&quot;</span>]</a>
<a class="sourceLine" id="cb30-17" data-line-number="17">}</a>
<a class="sourceLine" id="cb30-18" data-line-number="18"></a>
<a class="sourceLine" id="cb30-19" data-line-number="19"></a>
<a class="sourceLine" id="cb30-20" data-line-number="20"><span class="kw">ggplot</span>(df_race, <span class="kw">aes</span>(<span class="dt">x =</span> BORO_NM, <span class="dt">y =</span> adjusted))<span class="op">+</span></a>
<a class="sourceLine" id="cb30-21" data-line-number="21"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>,<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>,<span class="dt">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-22" data-line-number="22"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>VIC_RACE, <span class="dt">scales=</span><span class="st">&quot;free&quot;</span>, <span class="dt">nrow =</span> <span class="dv">3</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb30-23" data-line-number="23"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">6</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-24" data-line-number="24"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Crime Types&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Crime Rate&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Crimes faced by different races in different Boroughs&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-61-1.png" width="672" />
According to the graph, we don’t recommend students to live in STATEN ISLAND, because its crime rate is much greater than the other boroughs. And for students with different races, they can choose the region with low crime rate according to their own condition. For example, BRONX and MANHATTAN are more suitable for Asian students rather than BROOKLYN.</p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="missing-values.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="interactive-component.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/YOUR GITHUB USERNAME/YOUR REPO NAME/edit/master/05-results.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/YOUR GITHUB USERNAME/YOUR REPO NAME/blob/master/05-results.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
