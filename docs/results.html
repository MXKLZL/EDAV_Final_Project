<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Results | NYC Crime Analysis</title>
  <meta name="description" content="Chapter 5 Results | NYC Crime Analysis" />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Results | NYC Crime Analysis" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Results | NYC Crime Analysis" />
  
  
  

<meta name="author" content="Yichi Zhang, Zelin Li, Huayun Xu, Mingfang Chang" />


<meta name="date" content="2019-12-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="missing-values.html"/>
<link rel="next" href="interactive-component.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.css" rel="stylesheet" />
<link href="libs/leaflet-markercluster-1.0.5/MarkerCluster.Default.css" rel="stylesheet" />
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.freezable.js"></script>
<script src="libs/leaflet-markercluster-1.0.5/leaflet.markercluster.layersupport.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">NYC Crime Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="data-sources.html"><a href="data-sources.html"><i class="fa fa-check"></i><b>2</b> Data sources</a><ul>
<li class="chapter" data-level="2.1" data-path="data-sources.html"><a href="data-sources.html#nypd-complaint-data"><i class="fa fa-check"></i><b>2.1</b> NYPD Complaint Data</a></li>
<li class="chapter" data-level="2.2" data-path="data-sources.html"><a href="data-sources.html#united-states-census-bureau-quick-facts"><i class="fa fa-check"></i><b>2.2</b> United States Census Bureau Quick Facts</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>3</b> Data transformation</a><ul>
<li class="chapter" data-level="3.1" data-path="data-transformation.html"><a href="data-transformation.html#convert-type-and-fix-error-in-data"><i class="fa fa-check"></i><b>3.1</b> Convert Type and Fix Error in Data</a></li>
<li class="chapter" data-level="3.2" data-path="data-transformation.html"><a href="data-transformation.html#pick-out-relevant-crimes"><i class="fa fa-check"></i><b>3.2</b> Pick Out Relevant Crimes</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="missing-values.html"><a href="missing-values.html"><i class="fa fa-check"></i><b>4</b> Missing values</a></li>
<li class="chapter" data-level="5" data-path="results.html"><a href="results.html"><i class="fa fa-check"></i><b>5</b> Results</a><ul>
<li class="chapter" data-level="5.1" data-path="results.html"><a href="results.html#whcih-crime-types-are-more-common-in-each-borough"><i class="fa fa-check"></i><b>5.1</b> Whcih Crime Types Are More Common in Each Borough?</a></li>
<li class="chapter" data-level="5.2" data-path="results.html"><a href="results.html#which-borough-is-safer-based-on-crime-time"><i class="fa fa-check"></i><b>5.2</b> Which Borough is Safer Based on Crime Time?</a></li>
<li class="chapter" data-level="5.3" data-path="results.html"><a href="results.html#which-borough-is-safer-for-student-age-groups"><i class="fa fa-check"></i><b>5.3</b> Which Borough is Safer for Student Age Groups?</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="interactive-component.html"><a href="interactive-component.html"><i class="fa fa-check"></i><b>6</b> Interactive component</a></li>
<li class="chapter" data-level="7" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>7</b> Conclusion</a></li>
<li class="chapter" data-level="8" data-path="leaflet.html"><a href="leaflet.html"><i class="fa fa-check"></i><b>8</b> Interactive Geographic Data</a><ul>
<li class="chapter" data-level="8.1" data-path="leaflet.html"><a href="leaflet.html#overview"><i class="fa fa-check"></i><b>8.1</b> Overview</a></li>
<li class="chapter" data-level="8.2" data-path="leaflet.html"><a href="leaflet.html#brief-description-about-dataset"><i class="fa fa-check"></i><b>8.2</b> Brief Description about Dataset</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">NYC Crime Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="results" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Results</h1>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw">library</span>(choroplethrMaps)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="kw">library</span>(choroplethr)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="kw">library</span>(viridis)</a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="kw">library</span>(chron)</a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="kw">library</span>(tidyverse)</a></code></pre></div>
<p>In chapter 3, we have dropped some trivial crime types like “CRIMINAL MISCHIEF” and now we only pay attention to the common crime types of events happened in NYC. There are 11 crime types in total and we can see the frequency rank of them in the following graph.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">df1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(df_select[,<span class="dv">4</span>])</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">df1[<span class="st">&#39;count&#39;</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3">df1&lt;-<span class="st"> </span>df1 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="st">  </span><span class="kw">group_by</span>(df_select...<span class="fl">4.</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">Freq =</span> <span class="kw">sum</span>(count))</a>
<a class="sourceLine" id="cb3-6" data-line-number="6"></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="kw">ggplot</span>(df1, <span class="kw">aes</span>(<span class="kw">reorder</span>(df_select...<span class="fl">4.</span>,df1<span class="op">$</span>Freq), <span class="dt">y =</span> df1<span class="op">$</span>Freq)) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>,<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>,<span class="dt">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Crime Types&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Total amount&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Major Crimes in NYC&quot;</span>)</a></code></pre></div>
<p><img src="EDAVfinalproj_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>As we can see, THIEF is the most common crime in NYC and we deduce that this phenomenon may result from the low cost of theft. Offence also appears very common, because there are many different types of crime could be classified as OFFENCE. ARSON, MURDER and KIDNAPPING are the least common crime types in the dataset.</p>
<p>For the convenience of the later researches, we drop 5 types of crime from our dataset: ARSON, MURDER, KIDNAPPING, DRUG and FRAUD.</p>
<p>MURDER related data has great amount of missing data for latitude and longitude, also ARSON, MURDER and KIDNAPPING contain very few useful pieces of data, which is difficult to conduct instructive analysis. We drop FRAUD because this could be avoided effectively. For DRUG, although it is very common, usually it is the indirect reason for other crimes like offence or murder, the crime DRUG itself usually doesn’t cause great harm to the society.</p>
<div id="whcih-crime-types-are-more-common-in-each-borough" class="section level2">
<h2><span class="header-section-number">5.1</span> Whcih Crime Types Are More Common in Each Borough?</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">dangerous &lt;-<span class="kw">c</span>(<span class="st">&#39;BURGLARY&#39;</span>,<span class="st">&#39;OFFENSE&#39;</span>,<span class="st">&#39;RAPE&#39;</span>,<span class="st">&#39;ROBBERY&#39;</span>,<span class="st">&#39;THEFT&#39;</span>,<span class="st">&#39;WEAPON&#39;</span>)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">df_select &lt;-<span class="st"> </span>df_select <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">OFNS_DESC =</span> <span class="kw">ifelse</span>(OFNS_DESC <span class="op">%in%</span><span class="st"> </span>dangerous, OFNS_DESC, <span class="ot">NA</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">drop_na</span>(OFNS_DESC)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">df_select &lt;-<span class="st"> </span><span class="kw">drop_na</span>(df_select, BORO_NM)</a></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">DATA2 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;QuickFacts.csv&quot;</span>)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"></a>
<a class="sourceLine" id="cb5-3" data-line-number="3">DATA2 &lt;-DATA2[, <span class="kw">colSums</span>(<span class="kw">is.na</span>(DATA2)) <span class="op">!=</span><span class="st"> </span><span class="kw">nrow</span>(DATA2)]</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">DATA2 &lt;-DATA2[,<span class="op">-</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">8</span>)]</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">DATA2 &lt;-<span class="kw">as.data.frame</span>(<span class="kw">t</span>(DATA2))</a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="kw">names</span>(DATA2) &lt;-<span class="st"> </span><span class="kw">as.character</span>(<span class="kw">unlist</span>(DATA2[<span class="dv">1</span>,]))</a>
<a class="sourceLine" id="cb5-7" data-line-number="7">DATA2 &lt;-<span class="st"> </span>DATA2[<span class="op">-</span><span class="dv">1</span>,]</a>
<a class="sourceLine" id="cb5-8" data-line-number="8"></a>
<a class="sourceLine" id="cb5-9" data-line-number="9">DATA2 &lt;-<span class="kw">as.data.frame</span>(DATA2[,<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb5-10" data-line-number="10"></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="kw">names</span>(DATA2)&lt;-<span class="st">&#39;Population&#39;</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="kw">row.names</span>(DATA2) &lt;-<span class="kw">c</span>(<span class="st">&#39;MANHATTAN&#39;</span>,<span class="st">&#39;BRONX&#39;</span>,<span class="st">&#39;QUEENS&#39;</span>,<span class="st">&#39;BROOKLYN&#39;</span>,<span class="st">&#39;STATEN ISLAND&#39;</span>)</a>
<a class="sourceLine" id="cb5-14" data-line-number="14"></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"></a>
<a class="sourceLine" id="cb5-16" data-line-number="16">ChorDF &lt;-df_select<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="st">  </span><span class="kw">group_by</span>(df_select<span class="op">$</span>BORO_NM) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">count=</span><span class="kw">n</span>())<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="st">  </span><span class="kw">ungroup</span>()</a>
<a class="sourceLine" id="cb5-20" data-line-number="20"></a>
<a class="sourceLine" id="cb5-21" data-line-number="21">ChorDF &lt;-<span class="st"> </span><span class="kw">data.frame</span>(ChorDF[,<span class="op">-</span><span class="dv">1</span>], <span class="dt">row.names =</span> <span class="kw">unlist</span>(ChorDF[,<span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb5-22" data-line-number="22"></a>
<a class="sourceLine" id="cb5-23" data-line-number="23">ChorDF &lt;-<span class="st"> </span><span class="kw">merge</span>(ChorDF,DATA2,<span class="dt">by =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb5-24" data-line-number="24"></a>
<a class="sourceLine" id="cb5-25" data-line-number="25"></a>
<a class="sourceLine" id="cb5-26" data-line-number="26">ChorDF<span class="op">$</span>count &lt;-<span class="kw">as.numeric</span>(ChorDF<span class="op">$</span>count)</a>
<a class="sourceLine" id="cb5-27" data-line-number="27"></a>
<a class="sourceLine" id="cb5-28" data-line-number="28">ChorDF<span class="op">$</span>Population &lt;-<span class="kw">as.numeric</span>((<span class="kw">gsub</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">,&quot;</span>, <span class="st">&quot;&quot;</span>, ChorDF<span class="op">$</span>Population)))</a>
<a class="sourceLine" id="cb5-29" data-line-number="29"></a>
<a class="sourceLine" id="cb5-30" data-line-number="30">ChorDF &lt;-ChorDF <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-31" data-line-number="31"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">rate =</span> <span class="kw">as.double</span>(count<span class="op">/</span>Population)<span class="op">*</span><span class="dv">100000</span>)</a>
<a class="sourceLine" id="cb5-32" data-line-number="32"></a>
<a class="sourceLine" id="cb5-33" data-line-number="33">ChorDF[,<span class="st">&#39;region&#39;</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb5-34" data-line-number="34"></a>
<a class="sourceLine" id="cb5-35" data-line-number="35"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(ChorDF)){</a>
<a class="sourceLine" id="cb5-36" data-line-number="36">  <span class="cf">if</span>(ChorDF[i,<span class="dv">1</span>] <span class="op">==</span><span class="st"> &#39;BRONX&#39;</span>){ChorDF[i,<span class="st">&#39;region&#39;</span>] &lt;-<span class="dv">36005</span>}</a>
<a class="sourceLine" id="cb5-37" data-line-number="37">  <span class="cf">if</span>(ChorDF[i,<span class="dv">1</span>] <span class="op">==</span><span class="st"> &#39;BROOKLYN&#39;</span>){ChorDF[i,<span class="st">&#39;region&#39;</span>] &lt;-<span class="dv">36047</span>}</a>
<a class="sourceLine" id="cb5-38" data-line-number="38">  <span class="cf">if</span>(ChorDF[i,<span class="dv">1</span>] <span class="op">==</span><span class="st"> &#39;MANHATTAN&#39;</span>){ChorDF[i,<span class="st">&#39;region&#39;</span>] &lt;-<span class="dv">36061</span>}</a>
<a class="sourceLine" id="cb5-39" data-line-number="39">  <span class="cf">if</span>(ChorDF[i,<span class="dv">1</span>] <span class="op">==</span><span class="st"> &#39;QUEENS&#39;</span>){ChorDF[i,<span class="st">&#39;region&#39;</span>] &lt;-<span class="st"> </span><span class="dv">36081</span>}</a>
<a class="sourceLine" id="cb5-40" data-line-number="40">  <span class="cf">if</span>(ChorDF[i,<span class="dv">1</span>] <span class="op">==</span><span class="st"> &#39;STATEN ISLAND&#39;</span>){ChorDF[i,<span class="st">&#39;region&#39;</span>] &lt;-<span class="dv">36085</span>}</a>
<a class="sourceLine" id="cb5-41" data-line-number="41">}</a>
<a class="sourceLine" id="cb5-42" data-line-number="42"></a>
<a class="sourceLine" id="cb5-43" data-line-number="43"><span class="kw">colnames</span>(ChorDF)[<span class="dv">4</span>] &lt;-<span class="st">&#39;value&#39;</span></a>
<a class="sourceLine" id="cb5-44" data-line-number="44"></a>
<a class="sourceLine" id="cb5-45" data-line-number="45"></a>
<a class="sourceLine" id="cb5-46" data-line-number="46"><span class="kw">data</span>(county.regions)</a>
<a class="sourceLine" id="cb5-47" data-line-number="47">nyc_county_names =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;kings&quot;</span>, <span class="st">&quot;bronx&quot;</span>, <span class="st">&quot;new york&quot;</span>, <span class="st">&quot;queens&quot;</span>, <span class="st">&quot;richmond&quot;</span>)</a>
<a class="sourceLine" id="cb5-48" data-line-number="48">nyc_county_fips =<span class="st"> </span>county.regions <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-49" data-line-number="49"><span class="st">  </span><span class="kw">filter</span>(state.name <span class="op">==</span><span class="st"> &quot;new york&quot;</span> <span class="op">&amp;</span><span class="st"> </span>county.name <span class="op">%in%</span><span class="st"> </span>nyc_county_names) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-50" data-line-number="50"><span class="st">  </span><span class="kw">select</span>(region)</a>
<a class="sourceLine" id="cb5-51" data-line-number="51"><span class="kw">county_choropleth</span>(ChorDF,</a>
<a class="sourceLine" id="cb5-52" data-line-number="52">                  <span class="dt">title =</span> <span class="st">&quot;Number of Selected Crime per 100000 Population for Five Borough&quot;</span>,</a>
<a class="sourceLine" id="cb5-53" data-line-number="53">                  <span class="dt">legend =</span> <span class="st">&quot;Crime Rate&quot;</span>,</a>
<a class="sourceLine" id="cb5-54" data-line-number="54">                  <span class="dt">num_colors =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb5-55" data-line-number="55">                  <span class="dt">county_zoom =</span> nyc_county_fips<span class="op">$</span>region)<span class="op">+</span><span class="kw">scale_fill_viridis_c</span>()</a></code></pre></div>
<pre><code>## Scale for &#39;fill&#39; is already present. Adding another scale for &#39;fill&#39;,
## which will replace the existing scale.</code></pre>
<p><img src="EDAVfinalproj_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>After selecting the six crime types that most related to us, we take the population of each borough into account and calculate the crime rate of selected crime in five boroughs. The Boroughs with top three highest crime rate are Mahanttan, Bronx and Brooklyn, whereas Queens and Staten Island have lower crime rate, and this forms a spatial pattern in the graph. We are surprised about the finding, because it breaks our “stereotype” that Brooklyn is the most dangerous borough in New York City.</p>
<p>However,we cannot judge which county is more dangerous for us and which county is safer from this graph. Since different person may have different ranks for the dangerousness of the crime types.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co">#Cleveland dot plot</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">cleveland &lt;-df_select[,<span class="kw">c</span>(<span class="st">&#39;BORO_NM&#39;</span>,<span class="st">&#39;OFNS_DESC&#39;</span>)]</a>
<a class="sourceLine" id="cb7-4" data-line-number="4"></a>
<a class="sourceLine" id="cb7-5" data-line-number="5">cleveland[<span class="st">&#39;Freq&#39;</span>] =<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"></a>
<a class="sourceLine" id="cb7-7" data-line-number="7">cleveland &lt;-<span class="st"> </span>cleveland <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="st">  </span><span class="kw">group_by</span>(BORO_NM,OFNS_DESC) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">Freq =</span> <span class="kw">log</span>(<span class="kw">sum</span>(Freq),<span class="dv">2</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="st">  </span><span class="kw">ungroup</span>()</a>
<a class="sourceLine" id="cb7-11" data-line-number="11"></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"></a>
<a class="sourceLine" id="cb7-13" data-line-number="13">theme_dotplot &lt;-<span class="st"> </span><span class="kw">theme_bw</span>(<span class="dv">14</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="kw">rel</span>(.<span class="dv">55</span>)),</a>
<a class="sourceLine" id="cb7-15" data-line-number="15">          <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="kw">rel</span>(.<span class="dv">70</span>)),</a>
<a class="sourceLine" id="cb7-16" data-line-number="16">        <span class="dt">axis.ticks.y =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb7-17" data-line-number="17">        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="kw">rel</span>(.<span class="dv">70</span>)),</a>
<a class="sourceLine" id="cb7-18" data-line-number="18">        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="kw">rel</span>(.<span class="dv">70</span>)),</a>
<a class="sourceLine" id="cb7-19" data-line-number="19">        <span class="dt">panel.grid.major.x =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb7-20" data-line-number="20">        <span class="dt">panel.grid.major.y =</span> <span class="kw">element_line</span>(<span class="dt">size =</span> <span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb7-21" data-line-number="21">        <span class="dt">panel.grid.minor.x =</span> <span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb7-22" data-line-number="22"></a>
<a class="sourceLine" id="cb7-23" data-line-number="23"><span class="kw">ggplot</span>(cleveland,<span class="kw">aes</span>(Freq,<span class="kw">fct_reorder2</span>(BORO_NM,</a>
<a class="sourceLine" id="cb7-24" data-line-number="24">   OFNS_DESC <span class="op">==</span><span class="st"> &#39;THIEF&#39;</span>,Freq, <span class="dt">.desc =</span> <span class="ot">FALSE</span>),<span class="dt">color =</span> OFNS_DESC))<span class="op">+</span></a>
<a class="sourceLine" id="cb7-25" data-line-number="25"><span class="st">  </span><span class="kw">geom_point</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb7-26" data-line-number="26"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&#39;Boroughs&#39;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb7-27" data-line-number="27"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&#39;Crime Rate&#39;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb7-28" data-line-number="28"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&#39;Crime rate for each type by Boroughs &#39;</span>,<span class="dt">color =</span> <span class="st">&quot;Crime Type&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb7-29" data-line-number="29"><span class="st">  </span>theme_dotplot<span class="op">+</span></a>
<a class="sourceLine" id="cb7-30" data-line-number="30"><span class="st">  </span><span class="kw">theme_grey</span>(<span class="dv">16</span>)</a></code></pre></div>
<p><img src="EDAVfinalproj_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>The above graph shows the exact crime rate for each type in five boroughs. The most frequent crime types are OFFENSE and THEFT for all boroughs. As we discussed above, the cost of theft is the lowest and definiton of offense is broadly defined which could be the reason for high frequency of these two crime types.</p>
<p>Therefore, we focus on other four crime types. It is interesting that Brooklyn has highest crime rate for all four severe cirme types(Rape,Robbery,weapon,burglary) but the total crime rate of Brooklyn is actually lower than that of Manhattan. It seems like that the crimes happened in Brooklyn are more likely to be some severe crimes.</p>
<p>Bronx has the second highest total crime rate and also second highest rate for all severe crime types. Therefore neither Bronx nor Brooklyn is a good choice for student like us to live concerning safety.</p>
<p>For the Staten Island, the frepuency of all crime types are signifnatly lower than those of other four boroughs. From the safety concern, Staten Island may be a good choice for moving to. However, commute time should also be taken into account for final decision making.</p>
</div>
<div id="which-borough-is-safer-based-on-crime-time" class="section level2">
<h2><span class="header-section-number">5.2</span> Which Borough is Safer Based on Crime Time?</h2>
<p>First, We want to figure out if there is special time in the year where more crimes happen. So we build the following graph for recognizing time series patterns.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">df2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(df_select[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>])</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">df2[<span class="st">&#39;count&#39;</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3">df2&lt;-<span class="st"> </span>df2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="st">  </span><span class="kw">group_by</span>(CMPLNT_FR_DT) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">Freq =</span> <span class="kw">sum</span>(count))</a>
<a class="sourceLine" id="cb8-6" data-line-number="6"></a>
<a class="sourceLine" id="cb8-7" data-line-number="7">df2 &lt;-<span class="st"> </span>df2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="st">  </span><span class="kw">filter</span>(CMPLNT_FR_DT <span class="op">&gt;=</span><span class="kw">as.Date</span>(<span class="st">&#39;2019-01-01&#39;</span>) <span class="op">&amp;</span><span class="st"> </span>CMPLNT_FR_DT <span class="op">&lt;=</span><span class="kw">as.Date</span>(<span class="st">&#39;2019-9-25&#39;</span>))</a>
<a class="sourceLine" id="cb8-9" data-line-number="9"></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="kw">ggplot</span>(df2, <span class="kw">aes</span>(<span class="kw">as.Date</span>(CMPLNT_FR_DT), <span class="dt">y =</span> Freq)) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">color=</span><span class="st">&quot;orange&quot;</span>)<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>, <span class="dv">900</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Time&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Total amount&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Time series pattern in 2019&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="st">  </span><span class="kw">theme_grey</span>(<span class="dv">16</span>)</a></code></pre></div>
<p><img src="EDAVfinalproj_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>As shown in the graph, more crimes happened in the early Janaury and summer in 2019. Early Jauaury, especially during the new year celebration time, since more people went out for celebration, the raise of crime amount is reasonable. Besides, summer time is another period for more crimes. It may due to the relation between weather and people’s moods.</p>
<p>Since this research is aimed to find the suitable and safe region for university students to live, we want to see the time series pattern in each borough.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">df2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(df_select[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>])</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">df2[<span class="st">&#39;count&#39;</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"></a>
<a class="sourceLine" id="cb9-4" data-line-number="4">df2 &lt;-df2[<span class="op">!</span><span class="kw">is.na</span>(df2<span class="op">$</span>BORO_NM), ]</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">df2&lt;-<span class="st"> </span>df2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="st">  </span><span class="kw">group_by</span>(BORO_NM,CMPLNT_FR_DT) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">Freq =</span> <span class="kw">sum</span>(count))</a>
<a class="sourceLine" id="cb9-8" data-line-number="8"></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"></a>
<a class="sourceLine" id="cb9-10" data-line-number="10">df2 &lt;-<span class="st"> </span>df2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="st">  </span><span class="kw">filter</span>(CMPLNT_FR_DT <span class="op">&gt;=</span><span class="kw">as.Date</span>(<span class="st">&#39;2019-01-01&#39;</span>) <span class="op">&amp;</span><span class="st"> </span>CMPLNT_FR_DT <span class="op">&lt;=</span><span class="kw">as.Date</span>(<span class="st">&#39;2019-9-25&#39;</span>))</a>
<a class="sourceLine" id="cb9-12" data-line-number="12"></a>
<a class="sourceLine" id="cb9-13" data-line-number="13">df2[<span class="st">&quot;adjusted&quot;</span>] &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb9-14" data-line-number="14">df3 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(df2)</a>
<a class="sourceLine" id="cb9-15" data-line-number="15">DA &lt;-<span class="st"> </span><span class="kw">data.frame</span>(DATA2)</a>
<a class="sourceLine" id="cb9-16" data-line-number="16">DA<span class="op">$</span>Population &lt;-<span class="kw">as.numeric</span>((<span class="kw">gsub</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">,&quot;</span>, <span class="st">&quot;&quot;</span>, DA<span class="op">$</span>Population)))</a>
<a class="sourceLine" id="cb9-17" data-line-number="17"></a>
<a class="sourceLine" id="cb9-18" data-line-number="18"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1340</span>){</a>
<a class="sourceLine" id="cb9-19" data-line-number="19">  states &lt;-<span class="st"> </span>df3[i,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb9-20" data-line-number="20">  df3[i,<span class="st">&#39;adjusted&#39;</span>]&lt;-<span class="dv">100000</span><span class="op">*</span>df3[i,<span class="dv">3</span>]<span class="op">/</span>DA[states,<span class="st">&quot;Population&quot;</span>]</a>
<a class="sourceLine" id="cb9-21" data-line-number="21">}</a>
<a class="sourceLine" id="cb9-22" data-line-number="22"></a>
<a class="sourceLine" id="cb9-23" data-line-number="23"><span class="kw">ggplot</span>(df3, <span class="kw">aes</span>(<span class="kw">as.Date</span>(CMPLNT_FR_DT), <span class="dt">y =</span> Freq)) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-24" data-line-number="24"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">color=</span><span class="st">&quot;orange&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-25" data-line-number="25"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>BORO_NM, <span class="dt">scales=</span><span class="st">&quot;free&quot;</span>,<span class="dt">ncol =</span> <span class="dv">2</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb9-26" data-line-number="26"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Time&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Crime Rate&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Time series pattern in 2019 in different boroughs&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb9-27" data-line-number="27"><span class="st">  </span><span class="kw">theme_grey</span>(<span class="dv">16</span>)</a></code></pre></div>
<p><img src="EDAVfinalproj_files/figure-html/unnamed-chunk-15-1.png" width="480" /></p>
<p>Among 5 boroughs, There are small decline trends after August in all Boroughs except Manhattan which means the crime rate for all Boroughs except Manhattan may continued to decline after September. Since many lease periods begin around September, Queens may be a better choice to living than Manhattan from the plots above.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">picked_time &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;7am - 11am&quot;</span>, <span class="st">&quot;11am - 3pm&quot;</span>, <span class="st">&quot;3pm - 7pm&quot;</span>,<span class="st">&quot;7pm - 11pm&quot;</span>)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">crime_color &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;#7851a9&quot;</span>, <span class="st">&quot;#800020&quot;</span>, <span class="st">&quot;#ef5927&quot;</span>, <span class="st">&quot;#0079c1&quot;</span>, <span class="st">&quot;#dac751&quot;</span>, <span class="st">&quot;#133a30&quot;</span>)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3"></a>
<a class="sourceLine" id="cb10-4" data-line-number="4">df_select &lt;-<span class="st"> </span>df_select <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">drop_na</span>(BORO_NM)</a>
<a class="sourceLine" id="cb10-5" data-line-number="5">df_select &lt;-<span class="st"> </span>df_select <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">timerange =</span> CMPLNT_FR_TM)</a>
<a class="sourceLine" id="cb10-6" data-line-number="6">df_select &lt;-<span class="st"> </span>df_select <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">timerange =</span> <span class="kw">ifelse</span>(CMPLNT_FR_TM <span class="op">&gt;=</span><span class="st"> </span><span class="kw">chron</span>(<span class="dt">times=</span><span class="st">&quot;07:00:00&quot;</span>) </a>
<a class="sourceLine" id="cb10-7" data-line-number="7">                                                <span class="op">&amp;</span><span class="st"> </span>CMPLNT_FR_TM <span class="op">&lt;=</span><span class="st"> </span><span class="kw">chron</span>(<span class="dt">times=</span><span class="st">&quot;10:59:59&quot;</span>),</a>
<a class="sourceLine" id="cb10-8" data-line-number="8">                                                <span class="st">&quot;7am - 11am&quot;</span>, timerange) )</a>
<a class="sourceLine" id="cb10-9" data-line-number="9">df_select &lt;-<span class="st"> </span>df_select <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">timerange =</span> <span class="kw">ifelse</span>(CMPLNT_FR_TM <span class="op">&gt;=</span><span class="st"> </span><span class="kw">chron</span>(<span class="dt">times=</span><span class="st">&quot;11:00:00&quot;</span>) </a>
<a class="sourceLine" id="cb10-10" data-line-number="10">                                                <span class="op">&amp;</span><span class="st"> </span>CMPLNT_FR_TM <span class="op">&lt;=</span><span class="st"> </span><span class="kw">chron</span>(<span class="dt">times=</span><span class="st">&quot;14:59:59&quot;</span>),</a>
<a class="sourceLine" id="cb10-11" data-line-number="11">                                                <span class="st">&quot;11am - 3pm&quot;</span>, timerange) )</a>
<a class="sourceLine" id="cb10-12" data-line-number="12"></a>
<a class="sourceLine" id="cb10-13" data-line-number="13">df_select &lt;-<span class="st"> </span>df_select <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">timerange =</span> <span class="kw">ifelse</span>(CMPLNT_FR_TM <span class="op">&gt;=</span><span class="st"> </span><span class="kw">chron</span>(<span class="dt">times=</span><span class="st">&quot;15:00:00&quot;</span>) </a>
<a class="sourceLine" id="cb10-14" data-line-number="14">                                                <span class="op">&amp;</span><span class="st"> </span>CMPLNT_FR_TM <span class="op">&lt;=</span><span class="st"> </span><span class="kw">chron</span>(<span class="dt">times=</span><span class="st">&quot;18:59:59&quot;</span>),</a>
<a class="sourceLine" id="cb10-15" data-line-number="15">                                                <span class="st">&quot;3pm - 7pm&quot;</span>, timerange) )</a>
<a class="sourceLine" id="cb10-16" data-line-number="16">df_select &lt;-<span class="st"> </span>df_select <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">timerange =</span> <span class="kw">ifelse</span>(CMPLNT_FR_TM <span class="op">&gt;=</span><span class="st"> </span><span class="kw">chron</span>(<span class="dt">times=</span><span class="st">&quot;19:00:00&quot;</span>) </a>
<a class="sourceLine" id="cb10-17" data-line-number="17">                                                <span class="op">&amp;</span><span class="st"> </span>CMPLNT_FR_TM <span class="op">&lt;=</span><span class="st"> </span><span class="kw">chron</span>(<span class="dt">times=</span><span class="st">&quot;23:00:00&quot;</span>),</a>
<a class="sourceLine" id="cb10-18" data-line-number="18">                                                <span class="st">&quot;7pm - 11pm&quot;</span>, timerange) )</a>
<a class="sourceLine" id="cb10-19" data-line-number="19"></a>
<a class="sourceLine" id="cb10-20" data-line-number="20"><span class="co">#df_select &lt;- df_select %&gt;% mutate(color = timerange)</span></a>
<a class="sourceLine" id="cb10-21" data-line-number="21"><span class="co">#df_select &lt;- df_select %&gt;% mutate( color = ifelse(timerange == picked_time[1], &quot;red&quot;, color) )</span></a>
<a class="sourceLine" id="cb10-22" data-line-number="22"><span class="co">#df_select &lt;- df_select %&gt;% mutate( color = ifelse(timerange == picked_time[2], &quot;green&quot;, color) )</span></a>
<a class="sourceLine" id="cb10-23" data-line-number="23"><span class="co">#df_select &lt;- df_select %&gt;% mutate( color = ifelse(timerange == picked_time[3], &quot;blue&quot;, color) )</span></a>
<a class="sourceLine" id="cb10-24" data-line-number="24"></a>
<a class="sourceLine" id="cb10-25" data-line-number="25"><span class="co">#df_select &lt;- df_select %&gt;% mutate(crimecolor = OFNS_DESC)</span></a>
<a class="sourceLine" id="cb10-26" data-line-number="26"><span class="co">#for(i in 1:length(dangerous)){</span></a>
<a class="sourceLine" id="cb10-27" data-line-number="27">  <span class="co">#df_select &lt;- df_select %&gt;% mutate( crimecolor = ifelse(OFNS_DESC == dangerous[i], crime_color[i], crimecolor) )   </span></a>
<a class="sourceLine" id="cb10-28" data-line-number="28"><span class="co">#}</span></a>
<a class="sourceLine" id="cb10-29" data-line-number="29"></a>
<a class="sourceLine" id="cb10-30" data-line-number="30">df_select &lt;-<span class="st"> </span>df_select <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">timerange =</span> <span class="kw">ifelse</span>(timerange <span class="op">%in%</span><span class="st"> </span>picked_time, timerange, <span class="ot">NA</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">drop_na</span>(timerange)</a>
<a class="sourceLine" id="cb10-31" data-line-number="31"></a>
<a class="sourceLine" id="cb10-32" data-line-number="32">df_select<span class="op">$</span>timerange &lt;-<span class="st"> </span><span class="kw">factor</span>(df_select<span class="op">$</span>timerange, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;7am - 11am&quot;</span>,<span class="st">&quot;11am - 3pm&quot;</span>,<span class="st">&quot;3pm - 7pm&quot;</span>,<span class="st">&quot;7pm - 11pm&quot;</span>))</a></code></pre></div>
<p>As a student, we rent an apartment because we need to go to school or work. So it is very important to avoid the places that have a higher chance of crime when we are walking to school, or coming back to home. Therefore, we have broken down the time periods that the crime happened into four ranges:</p>
<ol style="list-style-type: decimal">
<li>7am - 11am</li>
<li>11am - 3pm</li>
<li>3pm - 7pm</li>
<li>7pm - 11pm</li>
</ol>
<p>The period we care most about are following:</p>
<ol style="list-style-type: decimal">
<li>7am - 11am (the time when we go to school or work)</li>
<li>3pm - 7pm (the time we go back to home )</li>
<li>7pm - 11pm (the time we go back to home when we have night class)</li>
</ol>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">ggplot</span>(df_select, <span class="kw">aes</span>(<span class="dt">x=</span>BORO_NM, ..count.., <span class="dt">fill=</span>timerange) )<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position=</span><span class="st">&quot;dodge&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Number of Crimes&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;The Distribution of Crime Events in Each Time Periods by Boroughs&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.title =</span> <span class="kw">element_blank</span>())<span class="op">+</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="st">  </span><span class="kw">theme_grey</span>(<span class="dv">16</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.title =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="EDAVfinalproj_files/figure-html/unnamed-chunk-17-1.png" width="672" />
From the graph above, there is same pattern for every borough. The desceding order of numebr of crimes is 3pm -7pm, 11am - 3pm, 7pm - 11pm, and 7am - 11am. Seperating the time period doesn’t help us figure out which borough has apprant advantage to live. However we can adjust our schedule base on the graph above. For example, if you live in Manhattan, going out before 11am and back to home after 7pm can help you avoid more crimes.</p>
<p>As full-time students, the frequency we go outside depends on days: we go out more frequently from Monday to Friday rather than weekends. Therefore we want to find a borough with lower frequency of crime events in weekdays, and the plot is as following:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw">library</span>(chron)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="kw">ggplot</span>(df_select, <span class="kw">aes</span>(<span class="kw">factor</span>(<span class="kw">weekdays</span>(CMPLNT_FR_DT,<span class="dt">abbreviate =</span><span class="ot">TRUE</span>), <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;Mon&quot;</span>, <span class="st">&quot;Tue&quot;</span>, <span class="st">&quot;Wed&quot;</span>, <span class="st">&quot;Thu&quot;</span>, <span class="st">&quot;Fri&quot;</span>, <span class="st">&quot;Sat&quot;</span>, <span class="st">&quot;Sun&quot;</span>))))<span class="op">+</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">fill=</span><span class="st">&quot;lightblue&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Weekdays and Weekends&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;The Number of Crime Events in Weekdays by Boroughs in New York City&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="st">&quot;BORO_NM&quot;</span>,<span class="dt">scale=</span><span class="st">&quot;free&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="st">  </span><span class="kw">theme_grey</span>(<span class="dv">16</span>)</a></code></pre></div>
<p><img src="EDAVfinalproj_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>Based on the above plot, the weekdays pattern is similar for each borough, where in the weekends the occurance of crime events is relatively infrequent compare to weekdays. Since we will go outside more during weekdays, the graph above dones’t help us find out the most suitable borough. However, the graph reminder us that we should try to choose safer periods to go outside in Friday.</p>
</div>
<div id="which-borough-is-safer-for-student-age-groups" class="section level2">
<h2><span class="header-section-number">5.3</span> Which Borough is Safer for Student Age Groups?</h2>
<p>Since most of full time students are in the age group 18-24, and we want to find how these students including us are related to the victims of crime events,so we extract the 18-24 group of each borough and draw the following barplot:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">df_age &lt;-<span class="st"> </span><span class="kw">subset</span>(df_select, <span class="kw">as.character</span>(VIC_AGE_GROUP) <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;&lt;18&quot;</span>, <span class="st">&quot;18-24&quot;</span>, <span class="st">&quot;25-44&quot;</span>, <span class="st">&quot;45-64&quot;</span>,<span class="st">&quot;65+&quot;</span>) )</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">df_age2&lt;-<span class="kw">subset</span>(df_age, <span class="kw">as.character</span>(VIC_AGE_GROUP)<span class="op">==</span><span class="st">&quot;18-24&quot;</span>)</a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="co">#df_age2 &lt;- df_age2$VIC_AGE_GROUP</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4">df_age2 &lt;-df_age2<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="st">  </span><span class="kw">group_by</span>(df_age2<span class="op">$</span>BORO_NM) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">count=</span><span class="kw">n</span>())<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="st">  </span><span class="kw">ungroup</span>()</a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="kw">names</span>(df_age2)[<span class="dv">1</span>] &lt;-<span class="st"> &quot;Borough&quot;</span></a>
<a class="sourceLine" id="cb13-9" data-line-number="9">df_age2<span class="op">$</span>count &lt;-<span class="st"> </span>df_age2<span class="op">$</span>count<span class="op">/</span>ChorDF<span class="op">$</span>Population<span class="op">*</span><span class="dv">100000</span></a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="kw">names</span>(df_age2)[<span class="dv">2</span>] &lt;-<span class="st"> &quot;Rate&quot;</span></a>
<a class="sourceLine" id="cb13-11" data-line-number="11"><span class="kw">ggplot</span>(df_age2, <span class="kw">aes</span>(<span class="dt">x=</span><span class="kw">reorder</span>(Borough, <span class="op">-</span>Rate), <span class="dt">y=</span>Rate))<span class="op">+</span></a>
<a class="sourceLine" id="cb13-12" data-line-number="12"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>,<span class="dt">fill=</span><span class="st">&quot;lightblue&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb13-13" data-line-number="13"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Boroughs&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb13-14" data-line-number="14"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;The Number of Victims per 100000 People in 18-24 Age Group by Boroughs in New York City&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb13-15" data-line-number="15"><span class="st">  </span><span class="kw">theme_grey</span>(<span class="dv">16</span>)</a></code></pre></div>
<p><img src="EDAVfinalproj_files/figure-html/unnamed-chunk-19-1.png" width="672" />
For the plot above, we convert the count of crime events to crime rate per 100000 people, and we can see clearly that Manhattan has the largest crime rate for age group 18-24, while Staten Island and Queens have the smallest crime rate. Combining with the result from crime types part(Manhattan and Queens are two best choice), Queens should be better choice for full time student than Manhattan.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="missing-values.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="interactive-component.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/MXKLZL/EDAV_Final_Project/edit/master/05-results.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/MXKLZL/EDAV_Final_Project/blob/master/05-results.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
