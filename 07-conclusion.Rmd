# Conclusion

# Interactive Geographic Data {#leaflet}

![](images/banners/banner_leaflet.png)
*This chapter originated as a community contribution created by [ AkhilPunia](https://github.com/AkhilPunia){target="_blank"}*

*This page is a work in progress. We appreciate any input you may have. If you would like to help improve this page, consider [contributing to our repo](contribute.html).*

## Overview

You would have already seen different libraries that can help one in beautifully displaying geographic data like `ggmap` and `choroplethr`. Even though these libraries provide lots of interesting features to better express information through 2-dimensional graphs, they still lack one feature: interactivity. Here comes `leaflet`---a library written in javascript to handle interactive maps. Fun Fact: It's actively used by a lot of leading newspapers like The New York Times and The Washington Post. 
Let's dive in.

## Brief Description about Dataset
For our analysis, we are using NYC Open Data about schools in New York City in 2016. [You can find more about it on the Kaggle page.](https://www.kaggle.com/passnyc/data-science-for-good/home){target="_blank"} We will be focusing on the the distribution of different variables as a factor of geographical positions.

```{r load library, eval=TRUE, message=FALSE}
library(tidyverse)
library(leaflet)
library(htmltools)
library(leaflet.extras)
library(viridis)
schools <- read_csv('2016_school_explorer.csv')
```

```{r}
quakes
```

```{r}
df.df <- split(df, df$timerange)

l <- leaflet() %>% addTiles()

names(df.df) %>%
  purrr::walk( function(df) {
    print(df)
    l <<- l %>%
      addMarkers(data=df.df[[df]],
                          lng=~Longitude, lat=~Latitude,
                          label=~OFNS_DESC,
                          popup=~OFNS_DESC,
                          group = df,
                          clusterOptions = markerClusterOptions(removeOutsideVisibleBounds = F),
                          labelOptions = labelOptions(noHide = F,
                                                       direction = 'auto'))
  })

l %>%
  addLayersControl(
    overlayGroups = names(df.df),
    options = layersControlOptions(collapsed = FALSE)
  )
```


```{r}


map <- leaflet(df) %>% 
  addTiles() %>% 
  addCircleMarkers(~Longitude, ~Latitude, 2, group=~timerange, color=~color, opacity=0.3, label =  ~OFNS_DESC, clusterOptions = markerClusterOptions()) %>% 
  addLayersControl(
    overlayGroups= c("07am - 11am", "15pm - 19pm", "19pm - 23pm"), 
    options = layersControlOptions(collapsed = FALSE),
    
  )
map
```


```{r}
df <- df_select %>% drop_na(Latitude, Longitude)

map <- leaflet(df) %>% 
  addTiles() %>% 
  addCircles(~Longitude, ~Latitude, 10, group=~timerange, color=~color, opacity=0.3, label =  ~OFNS_DESC) %>% 
  addLayersControl(
    overlayGroups= c("07am - 11am", "15pm - 19pm", "19pm - 23pm"), 
    options = layersControlOptions(collapsed = FALSE),
    
  )
map
```
